<!DOCTYPE html><html lang="zh">	<head>		<meta charset="UTF-8">		<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0">		<meta http-equiv="X-UA-Compatible" content="ie=edge">		<script src="js/jquery-2.0.0.min.js"></script>		<title>机考中心-中博教育</title>		<link rel="stylesheet" href="css/reset.css">		<script src="js/vconsole.min.js"></script>		<script>//			new VConsole()			//自动计算rem			! function(n) {				var e = n.document,					t = e.documentElement,					i = 750,					d = i / 100,					o = "orientationchange" in n ? "orientationchange" : "resize",					a = function() {						var n = t.clientWidth || 320;						n > 750 && (n = 750);						t.style.fontSize = n / d + "px"					};				e.addEventListener && (n.addEventListener(o, a, !1), e.addEventListener("DOMContentLoaded", a, !1))			}(window);		</script>		<link rel="stylesheet" href="css/cityChange.css">	</head>	<body>		<div class="container city-change">			<div class="city-top-search clearfix">				<!--<a href="javascript:;" class="go-back"></a>-->				<img src="image/search.png" class="search-icon" alt="">				<input type="search" class="search-box">			</div>			<div class="point-location">				<div id="list-wrapper">					<div class="mui-indexed-list-bar lister-bar" id="listerBar">					</div>					<div class="mui-indexed-list-alert"></div>					<div class="mui-indexed-list-inner">						<ul class="mui-table-view-divider nui-indexed-list-group" id="citylist">						</ul>					</div>				</div>			</div>			<div class="search-location">				<ul id="searUl">				</ul>			</div>		</div>		<script>			$(function() {				var lookArr = localStorage.getItem('lookArrs')&&localStorage.getItem('lookArrs').split(',')||[]				var lookId = localStorage.getItem('lookId')&&localStorage.getItem('lookId').split(',')||[]				//判断是否为ios				function isAnd(){				    var u = navigator.userAgent;				    var isAndoroid = u.indexOf('Android')>-1				    return isAndoroid				}								//判断是否为wap端				function isWap(){					let flag = true					var ua = navigator.userAgent;					var ipad = ua.match(/(iPad).*OS\s([\d_]+)/),										isIphone =!ipad && ua.match(/(iPhone\sOS)\s([\d_]+)/),										isAndroid = ua.match(/(Android)\s+([\d.]+)/),										isMobile = isIphone || isAndroid;										//判断					if(isMobile){						flag = true					}else{						flag = false					}					return flag;				}				var baseUrl = 'https://m.zbgedu.com/' 				if(isWap()){					var baseUrl = 'https://m.zbgedu.com/' 				}else{					var baseUrl = 'https://www.zbgedu.com/' 				}				var api = {					cityChange: baseUrl + 'shop_machine/Machine/_getksortdata',					searchCity:baseUrl +'shop_machine/Machine/search_fancy'				}				//设置cookie				function setCookie(name,value){					var Days = 30;					var exp = new Date();					exp.setTime(exp.getTime() + Days*24*60*60*1000);					document.cookie = name + "="+ escape (value) + ";expires=" + exp.toGMTString();				}				//读取cookie				function getCookie(name){					var arr,reg=new RegExp("(^| )"+name+"=([^;]*)(;|$)");					if(arr=document.cookie.match(reg))					return unescape(arr[2]);					else					return null;				}				//显示城市 cityChange				function getCity(){					$.ajax({						type:"GET",						url: api.cityChange,						async:true,						dataType:'json',								success:function(data){							console.log(data)							var tmpString = ''							var rightString = ''							for(var key in data){								rightString +='<span>'+key+'</span>'								tmpString +="<li data-group="+key+" class='mui-tab'>"+key+"</li>"+getNumCity(data[key])							}							$(document).find('#citylist').html(tmpString)							$(document).find('#listerBar').html(rightString)						}					});				}				//获取具体字母下的城市				function getNumCity(obj){					var tmpStr = ''					obj.forEach((item,index)=>{						tmpStr +="<li data-id="+item.id+">"+item.name+"</li>"					})					return tmpStr;				}				getCity()				//搜索城市				function searCity(key){					$.ajax({
						type:"get",
						url:api.searchCity,
						async:true,						dataType:'json',						data:{							search_name:key						},						success:function(res){							console.log(res)							console.log('++++++++')							if(res.state=='success'){								$(document).find('#searUl').html(getNumCity(res.data))							}						}
					});				}				//点击跳转到对应页面				function clickLi(id,name){					if(lookArr.indexOf(name)==-1){						lookId.unshift(id)						lookArr.unshift(name)					}					if(isAnd()){						console.log('Andoir')						setCookie('pointName',name)						setCookie('pointId',id)
						setCookie('lookArrs',lookArr)
						setCookie('lookId',lookId)											}else{						console.log('IOS')						localStorage.setItem('pointName',name)						localStorage.setItem('pointId',id)
						localStorage.setItem('lookArrs',lookArr)
						localStorage.setItem('lookId',lookId)					}					self.location='testCenter.html'				}															//点击锚链接				$(document).on('touchstart', '.lister-bar span', function() {					var txt = $(this).html()					var hasTxt = $('li[data-group="' + txt + '"]').html();					$('.mui-indexed-list-alert').html(txt)					$('.mui-indexed-list-alert').fadeIn(300);					setTimeout(function() {						$('.mui-indexed-list-alert').fadeOut(100);					}, 300)					if(hasTxt) {						var topHight = $('li[data-group="' + txt + '"]').offset().top;						var searchTop = $('.city-change').css('padding-top')						var searTop = $('.city-top-search').height()						$('html,body').animate({							scrollTop: topHight - parseInt(searchTop) - searTop						}, 800)					}				})				//输入搜索				if(isAnd()){					$('.search-box').on('keyup',function(){						console.log('and')					var this_txt = $.trim($(this).val());					if(this_txt){						searCity(this_txt)						$('.search-location').show();						$('.point-location').hide()					}else{						$('.search-location').hide();						$('.point-location').show()					}				})				}else{					$('.search-box').on('change',function(){					console.log('ios')					var this_txt = $.trim($(this).val());					console.log(this_txt)					if(this_txt){						searCity(this_txt)						$('.search-location').show();						$('.point-location').hide()					}else{						$('.search-location').hide();						$('.point-location').show()					}				})									}				/*$('.search-box').on('keyup',function(){					var this_txt = $.trim($(this).val());					if(this_txt){						searCity(this_txt)						$('.search-location').show();						$('.point-location').hide()					}else{						$('.search-location').hide();						$('.point-location').show()					}				})*/				//点击选中字母				$('.search-location li').on('click',function(){					var txt = $(this).html();					$('.search-box').val(txt)				})				$('.nui-indexed-list-group li').on('click',function(){					var txt = $(this).html();					$('.search-box').val(txt)				})				//区分点击与滑动				var flag = false;				var flagSear = false;				var $selector = $('#citylist');				var $searUl = $('#searUl')				$selector.on('touchstart touchmove touchend', function(event) {			    switch(event.type) {		        case 'touchstart':	            falg = false;	            break;		        case 'touchmove':	            falg = true;	             break;		        case 'touchend':            if( !falg ) {              if(event.target.dataset.id){              	clickLi(event.target.dataset.id,event.target.innerHTML)              }            } else {            	console.log('滚动')            }            break;			    }				});				$searUl.on('touchstart touchmove touchend', function(event) {			    switch(event.type) {		        case 'touchstart':	            flagSear = false;	            break;		        case 'touchmove':	            flagSear = true;	             break;		        case 'touchend':            if( !flagSear ) {              if(event.target.dataset.id){              	clickLi(event.target.dataset.id,event.target.innerHTML)              }            } else {            	console.log('滚动')            }            break;			    }				});			})		</script>	</body></html>